{"ast":null,"code":"import _toConsumableArray from\"/Users/heuchertc/sei/projects/lessthan30_django_env/lessthan30_frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/heuchertc/sei/projects/lessthan30_django_env/lessthan30_frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/heuchertc/sei/projects/lessthan30_django_env/lessthan30_frontend/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/heuchertc/sei/projects/lessthan30_django_env/lessthan30_frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/heuchertc/sei/projects/lessthan30_django_env/lessthan30_frontend/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/heuchertc/sei/projects/lessthan30_django_env/lessthan30_frontend/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{showPoem,deletePoem,indexWords,deleteWord}from'../../api/poem';import{withRouter}from'react-router-dom';import WordPanel from'./WordPanel';import Button from'react-bootstrap/Button';// parent of WordPanel\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var OnePoem=/*#__PURE__*/function(_Component){_inherits(OnePoem,_Component);var _super=_createSuper(OnePoem);function OnePoem(props){var _this;_classCallCheck(this,OnePoem);_this=_super.call(this,props);// funtion to pass to child\n_this.deletePoemButton=function(){var _this$props=_this.props,match=_this$props.match,user=_this$props.user,msgAlert=_this$props.msgAlert,history=_this$props.history;deletePoem(match.params.id,user).then(function(){return history.push('/poems');}).then(function(){msgAlert({heading:'Delete success',message:'Poem deleted </3',variant:'success'});}).catch(function(error){msgAlert({heading:'Delete fail',message:'Delete error: '+error.message,variant:'danger'});});};_this.deleteWordButton=function(wordId,index){var _this$props2=_this.props,match=_this$props2.match,user=_this$props2.user,msgAlert=_this$props2.msgAlert;deleteWord(match.params.id,wordId,user).then(function(){_this.state.words.splice(index,1);}).then(function(){msgAlert({heading:'Delete success',message:'Word deleted </3',variant:'success'});}).catch(function(error){msgAlert({heading:'Delete fail',message:'Delete error: '+error.message,variant:'danger'});});};_this.handler=_this.handler.bind(_assertThisInitialized(_this));_this.state={id:null,title:\"\",owner:null,stateChanged:false,words:[]};return _this;}_createClass(OnePoem,[{key:\"handler\",value:function handler(word){this.setState({words:[].concat(_toConsumableArray(this.state.words),[word])});}},{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var _this$props3=this.props,match=_this$props3.match,user=_this$props3.user,msgAlert=_this$props3.msgAlert;this.getPoemWords(match.params.id,user);showPoem(match.params.id,user).then(function(res){return _this2.setState({title:res.data.poem.title,id:res.data.poem.id,owner:res.data.poem.owner});}).then(function(){msgAlert({heading:'Viewing Poem',message:'Woot success',variant:'success'});}).catch(function(error){msgAlert({heading:'View failed',message:'Error message: '+error.message,variant:'danger'});});}},{key:\"getPoemWords\",value:function getPoemWords(id,user){var _this3=this;// const { match, user } = this.props\nindexWords(id,user).then(function(res){for(var item in res.data.words){_this3.setState({words:[].concat(_toConsumableArray(_this3.state.words),[res.data.words[item]])});//simple value\n}});}},{key:\"render\",value:function render(){var _this4=this;var _this$props4=this.props,user=_this$props4.user,msgAlert=_this$props4.msgAlert,match=_this$props4.match,history=_this$props4.history;var words=this.state.words;if(words===null){return'Loading...';}var poemJSX;if(words[0]===undefined){poemJSX='No words, add some!';}else{poemJSX=words.map(function(word,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"word\",children:[/*#__PURE__*/_jsx(\"h5\",{children:word.word}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return _this4.deleteWordButton(word.id,index);},className:\"delete-button\",children:\"X\"})]},index);});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Viewing Poem:\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"poem-header\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-link\",children:this.state.title}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return history.push(\"/updatepoem/\".concat(match.params.id,\"/\"));},children:\"Update\"}),/*#__PURE__*/_jsx(Button,{onClick:this.deletePoemButton,children:\"Delete\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"poem font-link\",children:poemJSX}),/*#__PURE__*/_jsx(WordPanel,{user:user,msgAlert:msgAlert,poemid:this.state.id,handler:this.handler,getPoemWords:this.getPoemWords})]})]});}}]);return OnePoem;}(Component);export default withRouter(OnePoem);","map":{"version":3,"sources":["/Users/heuchertc/sei/projects/lessthan30_django_env/lessthan30_frontend/src/components/Poems/OnePoem.js"],"names":["React","Component","showPoem","deletePoem","indexWords","deleteWord","withRouter","WordPanel","Button","OnePoem","props","deletePoemButton","match","user","msgAlert","history","params","id","then","push","heading","message","variant","catch","error","deleteWordButton","wordId","index","state","words","splice","handler","bind","title","owner","stateChanged","word","setState","getPoemWords","res","data","poem","item","poemJSX","undefined","map"],"mappings":"o6BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,QAAT,CAAmBC,UAAnB,CAA+BC,UAA/B,CAA2CC,UAA3C,KAA6D,gBAA7D,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,MAAOC,CAAAA,SAAP,KAAsB,aAAtB,CACA,MAAOC,CAAAA,MAAP,KAAmB,wBAAnB,CAEA;gJACMC,CAAAA,O,kGACJ,iBAAaC,KAAb,CAAoB,yCAClB,uBAAMA,KAAN,EACA;AAFkB,MAuDtBC,gBAvDsB,CAuDH,UAAM,CACvB,gBAA2C,MAAKD,KAAhD,CAAQE,KAAR,aAAQA,KAAR,CAAeC,IAAf,aAAeA,IAAf,CAAqBC,QAArB,aAAqBA,QAArB,CAA+BC,OAA/B,aAA+BA,OAA/B,CAEAZ,UAAU,CAACS,KAAK,CAACI,MAAN,CAAaC,EAAd,CAAkBJ,IAAlB,CAAV,CACGK,IADH,CACQ,iBAAMH,CAAAA,OAAO,CAACI,IAAR,CAAa,QAAb,CAAN,EADR,EAEGD,IAFH,CAEQ,UAAM,CACVJ,QAAQ,CAAC,CACPM,OAAO,CAAE,gBADF,CAEPC,OAAO,CAAE,kBAFF,CAGPC,OAAO,CAAE,SAHF,CAAD,CAAR,CAKD,CARH,EASGC,KATH,CASS,SAACC,KAAD,CAAW,CAChBV,QAAQ,CAAC,CACPM,OAAO,CAAE,aADF,CAEPC,OAAO,CAAE,iBAAmBG,KAAK,CAACH,OAF3B,CAGPC,OAAO,CAAE,QAHF,CAAD,CAAR,CAKD,CAfH,EAgBD,CA1EqB,OA4EtBG,gBA5EsB,CA4EH,SAACC,MAAD,CAASC,KAAT,CAAmB,CACpC,iBAAkC,MAAKjB,KAAvC,CAAQE,KAAR,cAAQA,KAAR,CAAeC,IAAf,cAAeA,IAAf,CAAqBC,QAArB,cAAqBA,QAArB,CAEAT,UAAU,CAACO,KAAK,CAACI,MAAN,CAAaC,EAAd,CAAkBS,MAAlB,CAA0Bb,IAA1B,CAAV,CACGK,IADH,CACS,UAAM,CACT,MAAKU,KAAL,CAAWC,KAAX,CAAiBC,MAAjB,CAAwBH,KAAxB,CAA+B,CAA/B,EACH,CAHH,EAIGT,IAJH,CAIQ,UAAM,CACVJ,QAAQ,CAAC,CACPM,OAAO,CAAE,gBADF,CAEPC,OAAO,CAAE,kBAFF,CAGPC,OAAO,CAAE,SAHF,CAAD,CAAR,CAKD,CAVH,EAWGC,KAXH,CAWS,SAACC,KAAD,CAAW,CAChBV,QAAQ,CAAC,CACPM,OAAO,CAAE,aADF,CAEPC,OAAO,CAAE,iBAAmBG,KAAK,CAACH,OAF3B,CAGPC,OAAO,CAAE,QAHF,CAAD,CAAR,CAKD,CAjBH,EAkBD,CAjGqB,CAGlB,MAAKS,OAAL,CAAe,MAAKA,OAAL,CAAaC,IAAb,+BAAf,CAEA,MAAKJ,KAAL,CAAa,CACTX,EAAE,CAAE,IADK,CAETgB,KAAK,CAAE,EAFE,CAGTC,KAAK,CAAE,IAHE,CAITC,YAAY,CAAE,KAJL,CAKTN,KAAK,CAAC,EALG,CAAb,CALkB,aAYnB,C,2CAED,iBAAQO,IAAR,CAAc,CACZ,KAAKC,QAAL,CAAc,CAACR,KAAK,8BAAK,KAAKD,KAAL,CAAWC,KAAhB,GAAuBO,IAAvB,EAAN,CAAd,EACD,C,iCAED,4BAAqB,iBACf,iBAAkC,KAAK1B,KAAvC,CAAQE,KAAR,cAAQA,KAAR,CAAeC,IAAf,cAAeA,IAAf,CAAqBC,QAArB,cAAqBA,QAArB,CACA,KAAKwB,YAAL,CAAkB1B,KAAK,CAACI,MAAN,CAAaC,EAA/B,CAAmCJ,IAAnC,EAEAX,QAAQ,CAACU,KAAK,CAACI,MAAN,CAAaC,EAAd,CAAkBJ,IAAlB,CAAR,CACCK,IADD,CACM,SAACqB,GAAD,QAAS,CAAA,MAAI,CAACF,QAAL,CAAc,CAC7BJ,KAAK,CAAEM,GAAG,CAACC,IAAJ,CAASC,IAAT,CAAcR,KADQ,CAE7BhB,EAAE,CAAEsB,GAAG,CAACC,IAAJ,CAASC,IAAT,CAAcxB,EAFW,CAG7BiB,KAAK,CAAEK,GAAG,CAACC,IAAJ,CAASC,IAAT,CAAcP,KAHQ,CAAd,CAAT,EADN,EAMChB,IAND,CAMM,UAAM,CACRJ,QAAQ,CAAC,CACTM,OAAO,CAAE,cADA,CAETC,OAAO,CAAE,cAFA,CAGTC,OAAO,CAAE,SAHA,CAAD,CAAR,CAKH,CAZD,EAaCC,KAbD,CAaO,SAACC,KAAD,CAAW,CACdV,QAAQ,CAAC,CACTM,OAAO,CAAE,aADA,CAETC,OAAO,CAAE,kBAAoBG,KAAK,CAACH,OAF1B,CAGTC,OAAO,CAAE,QAHA,CAAD,CAAR,CAKH,CAnBD,EAoBL,C,4BAED,sBAAcL,EAAd,CAAkBJ,IAAlB,CAAwB,iBAClB;AAEAT,UAAU,CAACa,EAAD,CAAKJ,IAAL,CAAV,CACCK,IADD,CACM,SAACqB,GAAD,CAAS,CACb,IAAK,GAAIG,CAAAA,IAAT,GAAiBH,CAAAA,GAAG,CAACC,IAAJ,CAASX,KAA1B,CAAiC,CAC/B,MAAI,CAACQ,QAAL,CAAc,CAAER,KAAK,8BAAM,MAAI,CAACD,KAAL,CAAWC,KAAjB,GAAyBU,GAAG,CAACC,IAAJ,CAASX,KAAT,CAAea,IAAf,CAAzB,EAAP,CAAd,EAAwE;AACzE,CACJ,CALC,EAML,C,sBAgDH,iBAAU,iBACR,iBAA2C,KAAKhC,KAAhD,CAAQG,IAAR,cAAQA,IAAR,CAAcC,QAAd,cAAcA,QAAd,CAAwBF,KAAxB,cAAwBA,KAAxB,CAA+BG,OAA/B,cAA+BA,OAA/B,CACA,GAAQc,CAAAA,KAAR,CAAkB,KAAKD,KAAvB,CAAQC,KAAR,CAEA,GAAIA,KAAK,GAAK,IAAd,CAAoB,CAClB,MAAO,YAAP,CACD,CACD,GAAIc,CAAAA,OAAJ,CACA,GAAId,KAAK,CAAC,CAAD,CAAL,GAAae,SAAjB,CAA4B,CAC1BD,OAAO,CAAG,qBAAV,CACD,CAFD,IAEO,CACHA,OAAO,CAAGd,KAAK,CAACgB,GAAN,CAAU,SAACT,IAAD,CAAOT,KAAP,qBAChB,aAAK,SAAS,CAAC,MAAf,wBACE,oBAAKS,IAAI,CAACA,IAAV,EADF,cAEE,KAAC,MAAD,EAAQ,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACX,gBAAL,CAAsBW,IAAI,CAACnB,EAA3B,CAA+BU,KAA/B,CAAN,EAAjB,CAA8D,SAAS,CAAC,eAAxE,eAFF,GAA2BA,KAA3B,CADgB,EAAV,CAAV,CAMH,CAED,mBACE,wCACA,qCADA,cAEE,oCACE,aAAK,SAAS,CAAC,aAAf,wBACI,WAAI,SAAS,CAAC,WAAd,UAA2B,KAAKC,KAAL,CAAWK,KAAtC,EADJ,cAEI,KAAC,MAAD,EAAQ,OAAO,CAAE,yBAAMlB,CAAAA,OAAO,CAACI,IAAR,uBAA4BP,KAAK,CAACI,MAAN,CAAaC,EAAzC,MAAN,EAAjB,oBAFJ,cAGI,KAAC,MAAD,EAAQ,OAAO,CAAE,KAAKN,gBAAtB,oBAHJ,GADF,cAOE,YAAK,SAAS,CAAC,gBAAf,UAAiCgC,OAAjC,EAPF,cASE,KAAC,SAAD,EAAW,IAAI,CAAE9B,IAAjB,CAAuB,QAAQ,CAAEC,QAAjC,CAA2C,MAAM,CAAE,KAAKc,KAAL,CAAWX,EAA9D,CAAkE,OAAO,CAAE,KAAKc,OAAhF,CAAyF,YAAY,CAAE,KAAKO,YAA5G,EATF,GAFF,GADF,CAgBD,C,qBAzIqBrC,S,EA4ItB,cAAeK,CAAAA,UAAU,CAACG,OAAD,CAAzB","sourcesContent":["import React, { Component } from 'react'\nimport { showPoem, deletePoem, indexWords, deleteWord } from '../../api/poem'\nimport { withRouter } from 'react-router-dom'\nimport WordPanel from './WordPanel'\nimport Button from 'react-bootstrap/Button'\n\n// parent of WordPanel\nclass OnePoem extends Component {\n  constructor (props) {\n    super(props)\n    // funtion to pass to child\n    this.handler = this.handler.bind(this)\n    \n    this.state = {\n        id: null,\n        title: \"\",\n        owner: null,\n        stateChanged: false,\n        words:[]\n    }\n  }\n\n  handler(word) {\n    this.setState({words:[...this.state.words, word]})\n  }\n\n  componentDidMount () {\n        const { match, user, msgAlert } = this.props\n        this.getPoemWords(match.params.id, user)\n\n        showPoem(match.params.id, user)\n        .then((res) => this.setState({\n        title: res.data.poem.title,\n        id: res.data.poem.id,\n        owner: res.data.poem.owner\n        }))\n        .then(() => {\n            msgAlert({\n            heading: 'Viewing Poem',\n            message: 'Woot success',\n            variant: 'success'\n            })\n        })\n        .catch((error) => {\n            msgAlert({\n            heading: 'View failed',\n            message: 'Error message: ' + error.message,\n            variant: 'danger'\n            })\n        })\n  }\n\n  getPoemWords (id, user) {\n        // const { match, user } = this.props\n\n        indexWords(id, user)\n        .then((res) => {\n          for (let item in res.data.words) {\n            this.setState({ words: [...this.state.words, (res.data.words[item])] }) //simple value\n          }\n      })\n  }\n\ndeletePoemButton = () => {\n  const { match, user, msgAlert, history } = this.props\n\n  deletePoem(match.params.id, user)\n    .then(() => history.push('/poems'))\n    .then(() => {\n      msgAlert({\n        heading: 'Delete success',\n        message: 'Poem deleted </3',\n        variant: 'success'\n      })\n    })\n    .catch((error) => {\n      msgAlert({\n        heading: 'Delete fail',\n        message: 'Delete error: ' + error.message,\n        variant: 'danger'\n      })\n    })\n}\n\ndeleteWordButton = (wordId, index) => {\n  const { match, user, msgAlert } = this.props\n\n  deleteWord(match.params.id, wordId, user)\n    .then( () => {\n        this.state.words.splice(index, 1);\n    })\n    .then(() => {\n      msgAlert({\n        heading: 'Delete success',\n        message: 'Word deleted </3',\n        variant: 'success'\n      })\n    })\n    .catch((error) => {\n      msgAlert({\n        heading: 'Delete fail',\n        message: 'Delete error: ' + error.message,\n        variant: 'danger'\n      })\n    })\n}\n\n\n\nrender () {\n  const { user, msgAlert, match, history } = this.props\n  const { words } = this.state\n\n  if (words === null) {\n    return 'Loading...'\n  }\n  let poemJSX \n  if (words[0] === undefined) {\n    poemJSX = 'No words, add some!'\n  } else {\n      poemJSX = words.map((word, index) => (\n          <div className=\"word\" key={index}>\n            <h5>{word.word}</h5>\n            <Button onClick={() => this.deleteWordButton(word.id, index)} className=\"delete-button\">X</Button>\n          </div>\n      ))\n  }\n\n  return (\n    <>\n    <h3>Viewing Poem:</h3>\n      <div>\n        <div className=\"poem-header\">\n            <h4 className=\"font-link\">{this.state.title}</h4>\n            <Button onClick={() => history.push(`/updatepoem/${match.params.id}/`)}>Update</Button>\n            <Button onClick={this.deletePoemButton}>Delete</Button>\n        </div>\n        \n        <div className=\"poem font-link\">{poemJSX}</div>\n\n        <WordPanel user={user} msgAlert={msgAlert} poemid={this.state.id} handler={this.handler} getPoemWords={this.getPoemWords}/>\n      </div>\n    </>\n  )\n}\n}\n\nexport default withRouter(OnePoem)\n"]},"metadata":{},"sourceType":"module"}